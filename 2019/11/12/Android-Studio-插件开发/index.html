<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Android Studio 插件开发 - why&#039;s Blog</title><meta description="Android Studio插件简介Android Studio插件，如果使用过flutter、gradle插件可能并不陌生，如图中我们平常使用gradle task的插件即为一个AS插件。AS插件可以为我们提供IDE中的使用界面、后台执行逻辑等等功能。 我最近在开发一个多仓管理的插件，翻阅资料发现目前intellij的源码文档很少，这里就把我读到用到的部分intellij的open-api中的代"><meta property="og:type" content="blog"><meta property="og:title" content="Android Studio 插件开发"><meta property="og:url" content="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"><meta property="og:site_name" content="why&#039;s Blog"><meta property="og:description" content="Android Studio插件简介Android Studio插件，如果使用过flutter、gradle插件可能并不陌生，如图中我们平常使用gradle task的插件即为一个AS插件。AS插件可以为我们提供IDE中的使用界面、后台执行逻辑等等功能。 我最近在开发一个多仓管理的插件，翻阅资料发现目前intellij的源码文档很少，这里就把我读到用到的部分intellij的open-api中的代"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/gradle.png"><meta property="og:image" content="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/pathDialog.png"><meta property="og:image" content="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/path.png"><meta property="og:image" content="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/background.png"><meta property="og:image" content="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/defaultActionGroup.png"><meta property="og:image" content="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/notification.png"><meta property="og:image" content="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/Messages.jpg"><meta property="article:published_time" content="2019-11-12T15:50:19.000Z"><meta property="article:modified_time" content="2020-08-12T16:01:37.506Z"><meta property="article:author" content="Michael Wang"><meta property="article:tag" content="Android"><meta property="article:tag" content="插件开发"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="../Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/gradle.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"},"headline":"why's Blog","image":["http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/gradle.png","http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/pathDialog.png","http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/path.png","http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/background.png","http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/defaultActionGroup.png","http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/notification.png","http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/Messages.jpg"],"datePublished":"2019-11-12T15:50:19.000Z","dateModified":"2020-08-12T16:01:37.506Z","author":{"@type":"Person","name":"Michael Wang"},"description":"Android Studio插件简介Android Studio插件，如果使用过flutter、gradle插件可能并不陌生，如图中我们平常使用gradle task的插件即为一个AS插件。AS插件可以为我们提供IDE中的使用界面、后台执行逻辑等等功能。 我最近在开发一个多仓管理的插件，翻阅资料发现目前intellij的源码文档很少，这里就把我读到用到的部分intellij的open-api中的代"}</script><link rel="canonical" href="http://yoursite.com/2019/11/12/Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="why&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Mrhwmichael/"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-12T15:50:19.000Z" title="2019-11-12T15:50:19.000Z">2019-11-12</time><span class="level-item">16 minutes read (About 2426 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Android Studio 插件开发</h1><div class="content"><h2 id="Android-Studio插件简介"><a href="#Android-Studio插件简介" class="headerlink" title="Android Studio插件简介"></a>Android Studio插件简介</h2><p>Android Studio插件，如果使用过flutter、gradle插件可能并不陌生，如图中我们平常使用gradle task的插件即为一个AS插件。AS插件可以为我们提供IDE中的使用界面、后台执行逻辑等等功能。</p>
<p>我最近在开发一个多仓管理的插件，翻阅资料发现目前intellij的源码文档很少，这里就把我读到用到的部分intellij的open-api中的代码分享一下，使用这些api将帮助我们快速的完成一些内容的开发，这其中大部分都来自于ide的源码。这里贴上ide源码的链接，想要了解IDE更多内部机制可以通过阅读源码来探究。 <a href="IDE源码">https://github.com/JetBrains/intellij-community</a></p>
<p>本篇主要分析一下常用Intellij的几个实用api，都是从上面IDE的源码中捞出来的，希望能帮到开发相关插件的同学节省时间。开发时间为2019.9，不确定其中的api在最新版IDEA和Android Studio中仍然适用，仅供参考。</p>
<h2 id="整体方向"><a href="#整体方向" class="headerlink" title="整体方向"></a>整体方向</h2><p>无论是IDEA还是Android Studio，都是基于java编写的，我们在写插件的时候也是使用java语言，并使用./gradlew runIde的命令运行我们的程序。UI的编写可以使用IDEA中的Java GUI，这样可以直接通过组件拖拽来完成简单的开发。但是想要完成更精美的UI还是建议完全用代码实现，由于java中缺少类似于安卓中relative layout和富文本等等组件，因此在开发中使用swing也会更加‘原始’，不熟悉这部分UI编写可以直接新建form文件并使用拖拽组件进行开发。</p>
 <a id="more"></a>

<h2 id="实现一个按钮"><a href="#实现一个按钮" class="headerlink" title="实现一个按钮"></a>实现一个按钮</h2><p>插件的配置定义在resources/META-INF/plugin.xml中，如果想定义一个菜单的按钮或右键按钮，请使用以下action来配置，通过更改group-id，我们可以更改此按钮的位置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">id</span>=<span class="string">"MRInfoAction"</span> <span class="attr">class</span>=<span class="string">"com.example.test.ExampleAction"</span> <span class="attr">text</span>=<span class="string">"按钮文本"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">description</span>=<span class="string">"描述信息"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">add-to-group</span> <span class="attr">group-id</span>=<span class="string">"EditorPopupMenu"</span> <span class="attr">anchor</span>=<span class="string">"last"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">keyboard-shortcut</span> <span class="attr">keymap</span>=<span class="string">"$default"</span> <span class="attr">first-keystroke</span>=<span class="string">"meta M"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个ExampleAction要继承自AnAction，需要实现actionPerform方法，方法传入一个AnActionEvent，这个方法内需要实现的就是AnAction需要执行的过程了。</p>
<p>如果想让按钮不需要index就可以点按，请实现DumbAware并加入以下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isDumbAware</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="实现一个面板"><a href="#实现一个面板" class="headerlink" title="实现一个面板"></a>实现一个面板</h2><p>同样在resources/META-INF/plugin.xml中，如果想定义一个侧边栏，请使用以下配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">extensions</span> <span class="attr">defaultExtensionNs</span>=<span class="string">"com.intellij"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">toolWindow</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">icon</span>=<span class="string">"xxx"</span> <span class="attr">anchor</span>=<span class="string">"left"</span> <span class="attr">factoryClass</span>=<span class="string">"com.example.test.ExampleFactory"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个ExampleFactory要继承自ToolWindowFactory，实现一个createToolWindowContent方法，这个方法用来创建面板，会传入项目project和toolwindow两个参数。</p>
<p> <img src="../Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/gradle.png" alt="面板示例"></p>
<h2 id="实现按钮打开Android-Studio"><a href="#实现按钮打开Android-Studio" class="headerlink" title="实现按钮打开Android Studio"></a>实现按钮打开Android Studio</h2><p>如果想实现一键打开AndroidStudio的功能，我们就要深入Intellij的源码来看一下打开操作是如何实现的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">IdeFrame frame = IdeFocusManager.getGlobalInstance().getLastFocusedFrame();</span><br><span class="line"><span class="keyword">final</span> Project projectToClose = frame != <span class="keyword">null</span> ? frame.getProject() : <span class="keyword">null</span>;</span><br><span class="line">EnumSet&lt;PlatformProjectOpenProcessor.Option&gt; options = EnumSet.noneOf(PlatformProjectOpenProcessor.Option<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="keyword">final</span> File tempFile = <span class="keyword">new</span> File(mModel.getLocalPath());</span><br><span class="line"><span class="keyword">final</span> VirtualFile baseDir = ApplicationManager.getApplication().runWriteAction(</span><br><span class="line">        (Computable&lt;VirtualFile&gt;) () -&gt; LocalFileSystem.getInstance().refreshAndFindFileByIoFile(tempFile));</span><br><span class="line">Project project = PlatformProjectOpenProcessor.doOpenProject(baseDir, projectToClose, -<span class="number">1</span>, <span class="keyword">null</span>, options);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (project != <span class="keyword">null</span>) &#123;</span><br><span class="line">    MultiRepoProjectCreator.disableGradleProjectMigrationNotification(project);</span><br><span class="line">    MultiRepoProjectCreator.disableUserConfig(project);</span><br><span class="line">    StartupManager.getInstance(project).registerPostStartupActivity(</span><br><span class="line">            () -&gt; ApplicationManager.getApplication().invokeLater(</span><br><span class="line">                    () -&gt; &#123;</span><br><span class="line">                        <span class="comment">// We want to show the Project view, not the Android view since it doesn't make the Dart code visible.</span></span><br><span class="line">                        DumbService.getInstance(project).runWhenSmart(</span><br><span class="line">                                () -&gt; &#123;</span><br><span class="line">                                    ProjectView.getInstance(project).changeView(ProjectViewPane.ID);</span><br><span class="line">                                    <span class="comment">// If the window still does not pop to top, see DartVmServiceDebugProcess.focusProject().</span></span><br><span class="line">                                    ProjectUtil.focusProjectWindow(project, <span class="keyword">true</span>);</span><br><span class="line">                                &#125;);</span><br><span class="line">                    &#125;, ModalityState.defaultModalityState()));</span><br></pre></td></tr></table></figure>

<p>可以看到，这里是通过StartupManager来实现的打开窗口，我们只需要使用doOpenProject()传入Project即可实现打开的这一操作。</p>
<h2 id="实现文件缓存"><a href="#实现文件缓存" class="headerlink" title="实现文件缓存"></a>实现文件缓存</h2><p>当我们代码更改的时候，intellij不会实时将我们的更改写入文件，而是写入内存，因此如果想在插件中读取所有的更改，我们就需要将所有的更改先写入文件中。其实如果当我们打开terminal或鼠标在编辑器中失去焦点，ide就会自动帮我们执行这一步操作，在我们的插件中我们通过调用以下函数也能实现相似功能。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    FileDocumentManager.getInstance().saveAllDocuments();</span><br><span class="line">    SaveAndSyncHandler.getInstance().refreshOpenFiles();</span><br><span class="line">    VirtualFileManager.getInstance().refreshWithoutFileWatcher(<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="选取文件"><a href="#选取文件" class="headerlink" title="选取文件"></a>选取文件</h2><p>当我们需要用户选取某一文件路径的时候，Intellij为我们提供了选取文件的接口</p>
<p> <img src="../Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/pathDialog.png" alt="选择路径"></p>
<p>实现这样的文件选择器我们只需要使用FileChooserDescriptor类即可，然后把它加载一个TextFieldWithBrowseButton对象中就可以实现这样的功能，具体实现代码如下所示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">FileChooserDescriptor localPathChooserDescriptor = <span class="keyword">new</span> FileChooserDescriptor(<span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFileSelectable</span><span class="params">(VirtualFile file)</span> </span>&#123;</span><br><span class="line">                VirtualFile gitFile = file.findChild(<span class="string">".git"</span>);</span><br><span class="line">                <span class="keyword">if</span> (gitFile != <span class="keyword">null</span> &amp;&amp; gitFile.isDirectory()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">localPathChooserDescriptor.setTitle(<span class="string">"选择路径"</span>);</span><br><span class="line">localPathChooserDescriptor.setForcedToUseIdeaFileChooser(<span class="keyword">true</span>);<span class="comment">//使用idea的窗口打开，而不是苹果的finder，这里IDEA有一个窗口显示的判断逻辑</span></span><br><span class="line">myLocalPath.addBrowseFolderListener(<span class="keyword">new</span> TextBrowseFolderListener(localPathChooserDescriptor));</span><br></pre></td></tr></table></figure>

<p>这样我们就有如下可以选择路径的UI</p>
<p> <img src="../Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/path.png" alt="选择路径"></p>
<h2 id="实现异步后台运行"><a href="#实现异步后台运行" class="headerlink" title="实现异步后台运行"></a>实现异步后台运行</h2><p>我们平时在用的很多task，例如update indices和gradle sync，都是通过Background Task来实现的，可以在我们的右下角看到</p>
<p> <img src="../Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/background.png" alt="后台运行任务"></p>
<p>这一Task队列是由platform-api.jar中的Task类里Backgroundable来实现的。这里当我们需要添加一个后台运行队列的时候，只需要将我们需要干的事放到run()中，然后在progress中运行task，就可以得到</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Task.Backgroundable task = <span class="keyword">new</span> Task.Backgroundable(project,<span class="string">"text"</span>,<span class="keyword">false</span>) &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(@NotNull ProgressIndicator indicator)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//这里是background的执行</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onSuccess();</span><br><span class="line">        <span class="comment">//这里是background执行成功的操作</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCancel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>.onCancel();</span><br><span class="line">            <span class="comment">//这里是background被用户取消的操作</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onThrowable</span><span class="params">(@NotNull Throwable error)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onThrowable(error);</span><br><span class="line">        <span class="comment">//这里是抛出异常的操作</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">ProgressManager.getInstance().runProcessWithProgressAsynchronously(task, <span class="keyword">new</span> BackgroundableProcessIndicator(task));</span><br></pre></td></tr></table></figure>

<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><p>我们的插件异常，除了自己catch住并且写入log中的，还有很多是会爆在IDE中的，这些异常会显示在右下角的红色感叹号中，点开会有IdeErrorsDialog弹出。如果开发一个插件，我们希望收集所有的插件异常，这时候就需要给IDE的消息弹出加一个监听器，这里我们还需要使用pluginId来定位问题出处，如以下代码所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">MessagePool.getInstance().addListener(<span class="keyword">new</span> MessagePoolListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">newEntryAdded</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;AbstractMessage&gt; errorList = MessagePool.getInstance().getFatalErrors(<span class="keyword">true</span>,<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">if</span>(errorList.size()!=<span class="number">0</span>)&#123;</span><br><span class="line">            AbstractMessage abstractMessage = errorList.get(errorList.size()-<span class="number">1</span>);</span><br><span class="line">            PluginId pluginId = IdeErrorsDialog.findPluginId(abstractMessage.getThrowable());</span><br><span class="line">            <span class="keyword">if</span>(pluginId.getIdString().equals(<span class="string">"xxx"</span>))&#123;</span><br><span class="line">                <span class="comment">//具体操作</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">poolCleared</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">entryWasRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这里IDE将异常信息封装为AbstractMessage类，通过这个类来实现很多具体方法，如果想对这一message进行操作，例如设为已读，只需要拿到对应AbstractMessage即可。</p>
<h2 id="执行系统命令"><a href="#执行系统命令" class="headerlink" title="执行系统命令"></a>执行系统命令</h2><p>这里我们可以直接使用java中的process来执行一个shell的cmd命令，方式如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Process p = Runtime.getRuntime().exec(<span class="keyword">new</span> String[]&#123;<span class="string">"sh"</span>, <span class="string">"-c"</span>, cmd&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="使用包装好的UI"><a href="#使用包装好的UI" class="headerlink" title="使用包装好的UI"></a>使用包装好的UI</h2><h3 id="DefaultActionGroup"><a href="#DefaultActionGroup" class="headerlink" title="DefaultActionGroup"></a>DefaultActionGroup</h3><p>intellij的源码为我们包装了按钮组这一个概念，即使用DefaultActionGroup来实现，具体来讲，我们可以新建一个ActionGroup的实例，然后在JPanel中添加即可。（注意，JPanel不可以选择GridLayoutManager，会出现异常，通常选BoxLayout或BorderLayout）这样我们就实现了类似下图的一排小icon的功能</p>
<p> <img src="../Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/defaultActionGroup.png" alt="icon列表"></p>
<p>而往ActionGroup中添加具体的按钮，即直接添加一个AnAction类的继承即可，每添加一个Action就会多一个点击Icon，而AnAction的实现可以如下面代码实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">addTokenAction</span> <span class="keyword">extends</span> <span class="title">AnAction</span> <span class="keyword">implements</span> <span class="title">DumbAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">addTokenAction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"name"</span>, <span class="string">"description"</span>, Icon icon);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(AnActionEvent e)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//加入按钮的点击事件</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isDumbAware</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  <span class="comment">//可选，若不实现接口默认false，就会在Updating indice（建立索引）阶段不可以使用</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Notification"><a href="#Notification" class="headerlink" title="Notification"></a>Notification</h3><p>Notification类可以让我们在右下角显示弹窗，实现类似下图的功能，并且将信息打入Event Log中</p>
<p> <img src="../Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/notification.png" alt="后台运行任务"></p>
<p>这里我们可以写一个静态方法放入工具类，只需要实现一个Notification类即可，代码如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">showErrorWithAction</span><span class="params">(String title, String message, Project project)</span></span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Notification notification = <span class="keyword">new</span> Notification(</span><br><span class="line">        <span class="string">"Messages"</span>,</span><br><span class="line">        title,</span><br><span class="line">        message,</span><br><span class="line">        NotificationType.ERROR);</span><br><span class="line"></span><br><span class="line">        notification.setIcon(MultiRepoIcons.NewProject);</span><br><span class="line">        notification.addAction(<span class="keyword">new</span> AnAction()&#123;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(@NotNull AnActionEvent e, @NotNull Notification notification)</span> </span>&#123;</span><br><span class="line">                <span class="comment">//加入点击事件</span></span><br><span class="line">            &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">        Notifications.Bus.notify(notification);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果希望进行一个弹窗通知，可以使用Messages.showMessageDialog或showErrorDialog方法，注意这个方法不能在子线程中执行，不然会没有效果。</p>
<p> <img src="../Android-Studio-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/Messages.jpg" alt="后台运行任务"></p>
<h3 id="其他UI"><a href="#其他UI" class="headerlink" title="其他UI"></a>其他UI</h3><p>除此之外，Intellij的官方API还有很多我们能调用的UI，比如loading的转圈UI，可以通过以下代码实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> AsyncProcessIcon myAnimatedIcon = <span class="keyword">new</span> AsyncProcessIcon(<span class="string">"add"</span>);</span><br></pre></td></tr></table></figure>

<p>总之，在编写插件UI的时候，与其自己用java swing去绘制不如看看Intellij源码，很多地方只需要调接口就能轻松完成，例如DialogWrapper类，因此开发之前不如先看看源码再着手编写</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上是我开发插件所用到的接口与实用类，除此之外也还用到了JGit和gitlab4j等开源库，后续也会将这两个git和gitlab相关的库与git的命令分享出来。</p>
</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Android/">Android</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/">插件开发</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/img/alipay.jpg" alt="Alipay"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/img/wechatpay.jpg" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/11/17/Windows%E5%BB%BA%E7%AB%8B%E5%8D%9A%E5%AE%A2%E8%B8%A9%E5%9D%91/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Windows系统建立博客踩坑</span></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Michael Wang"></figure><p class="title is-size-4 is-block line-height-inherit">Michael Wang</p><p class="is-size-6 is-block">Android intern &amp; BUPT undergraduate</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Beijing, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">21</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Mrhwmichael/" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Mrhwmichael/"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://weibo.com/u/2928617807?is_hot=1"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/%E6%98%8A%E5%AE%87-%E7%8E%8B-b3645a16b/"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://www.codesheep.cn/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">程序羊的Blog</span></span><span class="level-right"><span class="level-item tag">www.codesheep.cn</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://morvanzhou.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">莫烦Python</span></span><span class="level-right"><span class="level-item tag">morvanzhou.github.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://www.jianshu.com/u/203b606b956c" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">厘米姑娘简书</span></span><span class="level-right"><span class="level-item tag">www.jianshu.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-08-12T14:00:04.000Z">2020-08-12</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/12/gradle%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/">gradle插件开发快速上手</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-08-01T03:12:58.000Z">2020-08-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/01/flutter-%E5%AD%A6%E4%B9%A0/">flutter 学习</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-07-01T10:19:39.000Z">2020-07-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/07/01/%E5%A4%B4%E6%9D%A1%E5%AE%9E%E4%B9%A0-2020%E4%B8%8A%E5%8D%8A%E5%B9%B4%E6%80%BB%E7%BB%93/">头条实习-2020上半年总结</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-07T03:32:14.000Z">2020-06-07</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/07/%E4%BB%8E%E6%98%A5%E8%8A%82%E6%B4%BB%E5%8A%A8%E7%9C%8B%E4%BA%92%E8%81%94%E7%BD%91app%E5%8F%91%E5%B1%95/">从春节活动看互联网app发展</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-01-16T09:48:41.000Z">2020-01-16</time></p><p class="title is-6"><a class="link-muted" href="/2020/01/16/%E7%AB%8B%E4%B8%AAFLAG/">立个FLAG</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Android/"><span class="tag">Android</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Flag/"><span class="tag">Flag</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gradle%E6%8F%92%E4%BB%B6/"><span class="tag">gradle插件</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/keras/"><span class="tag">keras</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nlp/"><span class="tag">nlp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tensorflow/"><span class="tag">tensorflow</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%90%8E%E7%AB%AF/"><span class="tag">后端</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8/"><span class="tag">字节跳动</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/"><span class="tag">实习总结</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9E%E4%B9%A0%E7%BB%8F%E9%AA%8C/"><span class="tag">实习经验</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%A2%E6%88%B7%E7%AB%AF/"><span class="tag">客户端</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"><span class="tag">插件开发</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%98%A5%E8%8A%82%E6%B4%BB%E5%8A%A8/"><span class="tag">春节活动</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B5%8B%E8%AF%95/"><span class="tag">测试</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9B%B8%E6%9C%BA/"><span class="tag">相机</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%84%E4%BB%B6%E5%8C%96/"><span class="tag">组件化</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86/"><span class="tag">自然语言处理</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B7%A8%E5%B9%B3%E5%8F%B0/"><span class="tag">跨平台</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="why&#039;s Blog" height="28"></a><p class="size-small"><span>&copy; 2020 Michael Wang</span>  </p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Mail to me" href="mailto:mr_hw@outlook.com"><i class="fab fa-paper-plane"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Theme by icarus" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://yoursite.com',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>